# 目录
* [tcpip模型](#tcpip模型)
* [以太网协议](#以太网协议)
* [ARP地址解析协议](#ARP地址解析协议)
* [TCP协议](#TCP协议)

## tcpip模型

<table style="text-align:center">
   <tr>
      <td>OSI模型</td>
      <td>linux tcpip模型</td>
      <td>常用协议</td>
      <td>网络设备</td>
   </tr>
   <tr>
      <td>网络层</td>
      <td rowspan="3">网络层</td>
      <td rowspan="3">telnet/DHCP/TFTP/FTP/MQTT/NFS/DNS/FTP/SNMP</td>
      <td rowspan="3"></td>
   </tr>
   <tr>
      <td>表示层</td>
   </tr>
   <tr>
      <td>会话层</td>
   </tr>
   <tr>
      <td>传输层</td>
      <td>传输层</td>
      <td>TCP/UDP</td>
      <td>四层交换机</td>
   </tr>
   <tr>
      <td>网络层</td>
      <td>网络层</td>
      <td>IP/ICMP/IGMP/ARP</td>
      <td>路由器，三层交换机</td>
   </tr>
   <tr>
      <td>数据链路层</td>
      <td rowspan="2">网络接口层</td>
      <td rowspan="2">Ethernet/PPP/PPPoE</td>
      <td>交换机（二层交换机），网桥，网卡（一半物理层，一半链路层）</td>
   </tr>
   <tr>
      <td>物理层</td>
      <td>中继器、集线器</td>
   </tr>
</table>

## 以太网协议

<table style="text-align:center">
   <tr>
      <td>前导码</td>
      <td>SFD</td>
      <td>目标地址</td>
      <td>源地址</td>
      <td>长度/类型</td>
      <td>数据</td>
      <td>CRC校验</td>
   </tr>
   <tr>
      <td>7字节</td>
      <td>1字节</td>
      <td>6字节</td>
      <td>6字节</td>
      <td>2字节</td>
      <td>46~1500字节</td>
      <td>4字节</td>
   </tr>
</table>

> 1. <strong>前导码和SFD：</strong> 不能算是以太网数据帧，是以太网在物理层上发送以太网数据时添加上去的。
> 2. <strong>长度/类型：</strong> 大于1518，表示该以太网帧中的数据属于哪个上层协议（0x0800:IP数据包；0x0806:ARP数据包）
> 3. <strong>单播地址、组播地址：</strong> 第一个字节的bit0为0代表单播地址，为1代表组播地址。

## ARP地址解析协议

<table style="text-align:center">
   <tr>
      <td>以太网首部</td>
      <td>硬件类型</td>
      <td>协议类型</td>
      <td>MAC地址长度</td>
      <td>协议地址长度</td>
      <td>OP</td>
      <td>源MAC地址</td>
      <td>源IP地址</td>
      <td>目标MAC地址</td>
      <td>目标IP地址</td>
   </tr>
   <tr>
      <td>14字节</td>
      <td>2字节</td>
      <td>2字节</td>
      <td>1字节</td>
      <td>1字节</td>
      <td>2字节</td>
      <td>6字节</td>
      <td>4字节</td>
      <td>6字节</td>
      <td>4字节</td>
   </tr>
</table>

> 1. <strong>MAC地址长度和IP地址长度：</strong> 分别为6和4.
> 2. <strong>OP：</strong>ARP请求（值为1）、ARP应答（值为2）。

## tcp协议

tcp三次握手：
1. 客户端发送一个SYN段（同步序号）指明客户打算连接的服务器端口，以及初始化序号(ISN) 。
2. 服务器发回包含服务器的初始序号的SYN报文段作为应答。同时，将确认序号(ACK)设置为客户的ISN加1以对客户的SYN 报文段进行确认。一个SYN将占用一个序号。
3. 客户必须将确认序号设置为服务器的ISN加1以对服务器的SYN报文段进行确认。
如下图所示：
![tcp协议图解](res/tcp协议图解.jpg)
# IP地址分类
IP地址=网络地址＋主机地址
|分类|开头|第一个字节范围|总体范围|掩码地址|说明|
|---|:---:|:----:|--------------|:---:|--|
|A类|0    |1~126  |1.0.0.0 - 126.255.255.255|255.0.0.0|给规模特别大的网络使用|
|B类|10   |128~191|128.0.0.0 - 191.255.255.255|255.255.0.0|给一般的中型网络|
|C类|110  |192~223|192.0.0.0 - 223.255.255.255|255.255.255.0|给小型网络|
|D类|1110 |224~239|224.0.0.0 - 239.255.255.255| - |用于多点广播（组播）|
|E类|11110|240~255|240.0.0.0 - 255.255.255.255| - |用于广播地址|
其他：
> 1. 主机号全为0表示本网络本身 主机号全为1表示本网络广播地址
> 2. 127.0.0.0 环路自检地址，表示任意主机本身
> 3. 0.0.0.0 表示本网络的本主机
> 4. 专用地址： A类：10.0.0.0—10.255.255.255，B类：172.16.0.0—172.31.255.255，C类：192.168.0.0—192.168.255.255。
> 5. IP地址与子网掩码相与得到网络号
## TCP与UDP的区别
|TCP|UDP|
|---|---|
|面向连接,需要三次握手，4次挥手|不需要建立连接 |
|无差错，不丢失，不重复，且按序到达|不保证数据可靠、按序到达|
|面向字节流|面向报文|
|有拥塞控制,不会使源主机的发送速率降低|没有拥塞控制|
|连接只能是点到点|支持一对一，一对多，多对一和多对多的交互通信|
|首部开销20字节|首部开销小，只有8个字节|
|ftp telnet http https SMTP POP3|DNS DHCP tftp IGMP RTP|

## ICMP协议
> 1. ICMP允许主机或路由报告差错情况和提供有关异常情况
> 2. ICMP是因特网的标准协议，属于IP层的协议。

### ping包